#!/usr/bin/env ruby
# encoding: utf-8

require 'yaml'

addLabel= <%= p('add_label') %>

       result=system("#{cmd} > /dev/null 2>&1")
       while !result && retry_count < MAX_RETRIES
         retry_count += 1
         sleep SLEEP_DURATION
         puts "retry #{retry_count}"
         result=system("#{cmd} > /dev/null 2>&1")
       end
       if !result
         failCmd.push("#{cmd}")
         puts "ACTION delayed after all commands: #{cmd}"
       end
       if result
          puts "ACTION SUCCESS: #{cmd}"
       end
     end

 }
 isOnFail=false
puts "============================="
puts " Retry unsuccessful ingress"
puts "============================="
puts ""
 failCmd.each { |cmd|
   result=system("#{cmd} > /dev/null")
         if !result
           puts "ACTION FAILED: #{cmd}"
           isOnFail=true
         end
         if result
            puts "ACTION SUCCESS: #{cmd}"
         end
 }
 if (isOnFail)
     fail("some action cannot be performed")
 end
puts "============================="
puts " Ingress done"




